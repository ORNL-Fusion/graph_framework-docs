<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Graph Framework: Absorption Models</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Graph Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('absorption_model.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Absorption Models</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#absorption_model_intro">Introduction</a><ul><li class="level2"><a href="#absorption_model_hot">Hot Plasma Dispersion Function</a><ul><li class="level3"><a href="#absorption_model_hotexpand">Expansion Terms</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#absorption_model_root">Root Find</a></li>
<li class="level1"><a href="#absorption_model_damping">Weak Damping</a></li>
<li class="level1"><a href="#absorption_model_devel">Developing new absorption models</a></li>
</ul>
</div>
<div class="textblock"><p>A description of the models for power absorption.</p>
<h1><a class="anchor" id="absorption_model_intro"></a>
Introduction</h1>
<p>This page documents the types of dispersion functions available. Tracing the ray is only the first step in the process. Along that, ray power is deposited into the plasma. For tracing the ray we assumed the wave number was always real. However, now we need to figure out what the imaginary component is.</p>
<hr  />
 <h2><a class="anchor" id="absorption_model_hot"></a>
Hot Plasma Dispersion Function</h2>
<p>To do this we now assume a hot plasma dispersion function. </p><p class="formulaDsp">
\begin{equation}D\left(\vec{x},\vec{k},\omega\right)=i\sigma\Gamma_{0}+\Gamma_{1}+\vec{n}_{\perp}\cdot\vec{n}_{\perp}\frac{P\omega}{\omega_{ce}}\left(1+\zeta Z\left(\zeta\right)\right)\left(\Gamma_{2} + \Gamma_{5}F\right)\equiv 0 \end{equation}
</p>
<p> Where </p><p class="formulaDsp">
\begin{equation}\Gamma_{0}=\vec{n}_{\perp}\cdot\vec{n}_{\perp}\left(\vec{n}\cdot\vec{n}-2\left(1-2q\right)\right)+\left(1-P\right)\left(2\left(1-2q\right)-\left(\vec{n}\cdot\vec{n}+n_{||}^{2}\right)\right)\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\Gamma_{1}=\vec{n}_{\perp}\cdot\vec{n}_{\perp}\left(\left(1-q\right)\vec{n}\cdot\vec{n}-(1-2q)\right)+\left(1-P\right)\left(\vec{n}\cdot\vec{n}n^{2}_{||} - \left(1-q\right)\left(\vec{n}\cdot\vec{n}+n^{2}_{||}\right)+\left(1-2q\right)\right)\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\Gamma_{2}=\left(\vec{n}\cdot\vec{n}-\left(1-2q\right)\right)+\frac{P\omega}{4\omega_{ce}n^{2}_{||}}\left(\left(\vec{n}\cdot\vec{n} + n^{2}_{||}\right)-2\left(1-2q\right)\right)\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\Gamma_{5}=\vec{n}\cdot\vec{n}n^{2}_{||}-\left(1-q\right)\left(\vec{n}\cdot\vec{n}+n^{2}_{||}\right)+\left(1-2q\right)\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}i\sigma=\frac{PZ\left(\zeta\right)}{2n_{||}v_{e}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\zeta=\frac{1-\frac{\omega_{ce}}{\omega}}{n_{||}\frac{v_{e}}{c}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}F=\frac{v_{e}\left(1+\zeta Z\left(\zeta\right)\right)\omega}{2n_{||}\omega_{ce}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}P=\frac{\omega^{2}_{pe}}{\omega^{2}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}q=\frac{P}{2\left(1+\frac{\omega_{ce}}{\omega}\right)}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}v_{e}=\sqrt{2n_{e}\frac{t_{e}}{m_{e}}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}Z\left(\zeta\right)=-\sqrt{\pi}e^{-\zeta^{s}}\left(efri\left(\zeta\right)-i\right)\end{equation}
</p>
<p> Where \(efri\left(\zeta\right)\) is the imaginary error function.</p>
<h3><a class="anchor" id="absorption_model_hotexpand"></a>
Expansion Terms</h3>
<p>The hot plasma dispersion function can be split to a hot plasma term and a cold plasma term. </p><p class="formulaDsp">
\begin{equation}D_{c}\left(\vec{x},\vec{k},\omega\right)=-\frac{P}{2}\left(1+\frac{\omega_{ce}}{\omega}\Gamma_{0}+\left(1-\frac{\omega^{2}_{ce}}{\omega^{2}}\Gamma_{1}\right)\right)\end{equation}
</p>
<p> Then the hot plasma term is </p><p class="formulaDsp">
\begin{equation}D_{h}\left(\vec{x},\vec{k},\omega\right)=-\left(1+\frac{\omega_{ce}}{\omega}\right)n_{||}\frac{v_{e}}{c}\left(\Gamma_{1}+\Gamma_{2}+\frac{\vec{n}_{\perp}\cdot\vec{n}_{\perp}}{2n^{2}_{||}}\frac{\omega^{2}}{\omega^{2}_{ce}}\frac{v_{e}}{c}\zeta\Gamma_{5}\right)\left(\frac{1}{Z\left(\zeta\right)}+\zeta\right)\end{equation}
</p>
<hr  />
 <h1><a class="anchor" id="absorption_model_root"></a>
Root Find</h1>
<p>One way to solve for the imaginary component is to locate the root of the hot plasma dispersion function using the cold plasma solution as an initial guess. We start by redefining \(\vec{k}=k_{amp}\hat{k}\) now we can solve for the complex value of \(k_{amp}\) using a <a class="el" href="namespacesolver.html#af0236e2736c071193fed379d294cc437">Newton method</a>.</p>
<hr  />
 <h1><a class="anchor" id="absorption_model_damping"></a>
Weak Damping</h1>
<p>Using the cold and hot expansion </p><p class="formulaDsp">
\begin{equation}k_{amp}=\sqrt{\vec{k}\cdot\vec{k}}-\frac{D_{h}}{\hat{k}\cdot\frac{\partial D_{c}}{\partial \vec{k}}}\end{equation}
</p>
<hr  />
 <h1><a class="anchor" id="absorption_model_devel"></a>
Developing new absorption models</h1>
<p>This section is intended for code developers and outlines how to create new absorption models. New absorption models can be created from a subclass of <a class="el" href="classabsorption_1_1method.html">absorption::method</a> or any other existing absorption class and overloading class methods. </p><div class="fragment"><div class="line"><span class="keyword">template</span>&lt;jit::complex_scalar T, <span class="keywordtype">bool</span> SAFE_MATH=true&gt;</div>
<div class="line"><span class="keyword">class </span>new_absorption final : <span class="keyword">public</span> method&lt;T, SAFE_MATH&gt; {</div>
<div class="line">    new_absorption(<a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> kamp,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> w,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> kx,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> ky,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> kz,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> x,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> y,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> z,</div>
<div class="line">                   <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> t,</div>
<div class="line">                   <a class="code hl_typedef" href="namespaceequilibrium.html#a9f4ba1563110e2443131808c94663444">equilibrium::shared&lt;T, SAFE_MATH&gt;</a> &amp;eq,</div>
<div class="line">                   <span class="keyword">const</span> std::string &amp;filename=<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                   <span class="keyword">const</span> <span class="keywordtype">size_t</span> index=0) {</div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> <a class="code hl_function" href="jit__test_8cpp.html#a27b34348d63e1712a46eef8cd89f8234">compile</a>() {</div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">void</span> run(<span class="keyword">const</span> <span class="keywordtype">size_t</span> time_index) {</div>
<div class="line">        ...</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="ajit__test_8cpp_html_a27b34348d63e1712a46eef8cd89f8234"><div class="ttname"><a href="jit__test_8cpp.html#a27b34348d63e1712a46eef8cd89f8234">compile</a></div><div class="ttdeci">void compile(graph::input_nodes&lt; T &gt; inputs, graph::output_nodes&lt; T &gt; outputs, graph::map_nodes&lt; T &gt; setters, const T expected, const T tolerance)</div><div class="ttdoc">Compile kernal and check the result of the output.</div><div class="ttdef"><b>Definition</b> jit_test.cpp:49</div></div>
<div class="ttc" id="anamespaceequilibrium_html_a9f4ba1563110e2443131808c94663444"><div class="ttname"><a href="namespaceequilibrium.html#a9f4ba1563110e2443131808c94663444">equilibrium::shared</a></div><div class="ttdeci">std::shared_ptr&lt; generic&lt; T, SAFE_MATH &gt; &gt; shared</div><div class="ttdoc">Convenience type alias for shared equilibria.</div><div class="ttdef"><b>Definition</b> equilibrium.hpp:472</div></div>
<div class="ttc" id="anamespacegraph_html_ac8853b055dcbbfd35dff9b4584d5ef36"><div class="ttname"><a href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf</a></div><div class="ttdeci">std::shared_ptr&lt; leaf_node&lt; T, SAFE_MATH &gt; &gt; shared_leaf</div><div class="ttdoc">Convenience type alias for shared leaf nodes.</div><div class="ttdef"><b>Definition</b> node.hpp:676</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
