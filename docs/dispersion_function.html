<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Graph Framework: Dispersion Functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Graph Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dispersion_function.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Dispersion Functions</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#dispersion_function_intro">Introduction</a></li>
<li class="level1"><a href="#dispersion_function_normal">Normalization</a></li>
<li class="level1"><a href="#dispersion_function_wave_propagation">Wave propagation</a></li>
<li class="level1"><a href="#dispersion_function_avail">Available Dispersion Functions</a><ul><li class="level2"><a href="#dispersion_function_simple">Simple</a></li>
<li class="level2"><a href="#dispersion_function_bohm_gross">Bohm Gross</a></li>
<li class="level2"><a href="#dispersion_function_o_wave">Ordinary Wave</a></li>
<li class="level2"><a href="#dispersion_function_x_wave">Extra Ordinary Wave</a></li>
<li class="level2"><a href="#dispersion_function_cold_plasma">Cold Plasma</a></li>
</ul>
</li>
<li class="level1"><a href="#dispersion_function_devel">Developing new dispersion functions</a></li>
</ul>
</div>
<div class="textblock"><p>Dispersion function documentation for the xrays RF Ray tracing code.</p>
<h1><a class="anchor" id="dispersion_function_intro"></a>
Introduction</h1>
<p>This page documents the types of dispersion functions available. As a ray moves through the plasma it must remain a solution of these functions. For a fixed wave frequency \(\omega \), the dispersion function dictates how the wave number \(\vec{k}\) and ray trajectory \(\vec{x}\) interact. </p><a class="anchor" id="dispersion_function_symbol"></a>
<table class="doxtable">
<caption>Symbol definitions</caption>
<tr>
<th>Symbol </th><th>Unit </th><th>Description </th></tr>
<tr>
<td>\(c \) </td><td>\(\frac{m}{s}\)</td><td>Speed of light. </td></tr>
<tr>
<td>\(m_{e}\) </td><td>\(kg \) </td><td>Electron mass </td></tr>
<tr>
<td>\(t_{e}\) </td><td>\(K \) </td><td>Electron temperature </td></tr>
<tr>
<td>\(n_{e}\) </td><td>\(m^{-3}\) </td><td>Electron Denisty </td></tr>
<tr>
<td>\(q \) </td><td>\(C \) </td><td>Fundamental Charge </td></tr>
<tr>
<td>\(\vec{B}\) </td><td>\(T \) </td><td>Magnetic field </td></tr>
<tr>
<td>\(\epsilon_{0}\)</td><td>\(\frac{F}{m}\)</td><td>Vacuum permittivity </td></tr>
<tr>
<td>\(k_{B}\) </td><td>\(\frac{J}{K}\)</td><td>Boltzmann constant </td></tr>
<tr>
<td>\(\omega_{pe}\) </td><td>\(s^{-1}\) </td><td>Electron Plasma Frequency \(\omega_{pe}=\frac{n_{e}q^{2}}{\epsilon_{0}m_{e}c}\) </td></tr>
<tr>
<td>\(\omega_{ce}\) </td><td>\(s^{-1}\) </td><td>Electron Cyclotron Frequency \(\omega_{ce}=\frac{q\left|\vec{B}\right|}{m_{e}}\) </td></tr>
<tr>
<td>\(\omega_{h}\) </td><td>\(s^{-1}\) </td><td>Upper Hybrid Frequency \(\omega_{h}^{s}=\omega_{pe}^{2}+\omega_{ce}^{2}\) </td></tr>
<tr>
<td>\(\omega_{r}\) </td><td>\(s^{-1}\) </td><td>Right cutoff Frequency \(\omega_{r}=\frac{1}{2}\left(\omega_{ce}+\sqrt{\omega^{2}_{ce}+4\omega_{pe}^{2}}\right)\) </td></tr>
<tr>
<td>\(\omega_{l}\) </td><td>\(s^{-1}\) </td><td>Left cutoff Frequency \(\omega_{r}=\frac{1}{2}\left(-\omega_{ce}+\sqrt{\omega^{2}_{ce}+4\omega_{pe}^{2}}\right)\) </td></tr>
<tr>
<td>\(v_{th}\) </td><td>\(\frac{m}{s}\)</td><td>Thermal velocity \(v_{th}=\sqrt{\frac{k_{B}t_{e}}{m_{e}}}\) </td></tr>
<tr>
<td>\(\vec{n}\) </td><td>\(1 \) </td><td>\(n=\frac{\vec{k}c}{\omega}\) </td></tr>
</table>
<h1><a class="anchor" id="dispersion_function_normal"></a>
Normalization</h1>
<p>The dispersion functions use normalized quantities for frequncy \(\omega \) and time \(t \). These are scaled to the speed of light \(c \). </p><a class="anchor" id="dispersion_function_normal_units"></a>
<table class="doxtable">
<caption>Disperion function units and normalizations</caption>
<tr>
<th>Symbol </th><th>Real Unit </th><th>Modified </th><th>Modified Unit</th><th>Description </th></tr>
<tr>
<td>\(\omega \) </td><td>\(s^{-1}\) </td><td>\(\omega&#39;=\frac{\omega}{c}\) </td><td>\(m^{-1}\) </td><td>Wave frequency </td></tr>
<tr>
<td>\(\vec{k}\) </td><td>\(m^{-1}\) </td><td>\(\vec{k}\) </td><td>\(m^{-1}\) </td><td>Wave number </td></tr>
<tr>
<td>\(t \) </td><td>\(s \) </td><td>\(t&#39;=tc \) </td><td>\(m \) </td><td>Time </td></tr>
<tr>
<td>\(\vec{x}\) </td><td>\(m \) </td><td>\(\vec{x}\) </td><td>\(m \) </td><td>Postion </td></tr>
<tr>
<td>\(v_{p}=\frac{\omega}{k}\) </td><td>\(\frac{m}{s}\)</td><td>\(v&#39;_{p}=\frac{\omega&#39;}{k}\) </td><td>\(1 \) </td><td>Phase velocity </td></tr>
<tr>
<td>\(v_{g}=\frac{\partial\omega}{\partial k}\)</td><td>\(\frac{m}{s}\)</td><td>\(v&#39;_{g}=\frac{\partial\omega&#39;}{\partial k}\)</td><td>\(1 \) </td><td>Group velocity </td></tr>
</table>
<h1><a class="anchor" id="dispersion_function_wave_propagation"></a>
Wave propagation</h1>
<p>From any dispersion function, the wave propagation equations are obtained from derivatives of the dispersion relation. </p><p class="formulaDsp">
\begin{equation}\frac{\partial\vec{x}}{\partial {t}}=-\frac{\frac{\partial D}{\partial\vec{k}}}{\frac{\partial D}{\partial\omega}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\frac{\partial\vec{k}}{\partial {t}}=\frac{\frac{\partial D}{\partial\vec{x}}}{\frac{\partial D}{\partial\omega}}\end{equation}
</p>
<p> RF waves are traced by integrating this system of equations.</p>
<h1><a class="anchor" id="dispersion_function_avail"></a>
Available Dispersion Functions</h1>
<p>The following dispersion functions are available in xrays.</p>
<h2><a class="anchor" id="dispersion_function_simple"></a>
Simple</h2>
<p>This disperison function represents a wave in a vacuum. </p><p class="formulaDsp">
\begin{equation}D\left(\vec{x},\vec{k},\omega\right)=\frac{\vec{k}\cdot\vec{k}}{\omega^{2}}-1\equiv 0 \end{equation}
</p>
<p> It has no resonances or cutoffs.</p>
<hr  />
 <h2><a class="anchor" id="dispersion_function_bohm_gross"></a>
Bohm Gross</h2>
<p>This dispersion function now accounts for how occilations in the plasma propagate. </p><p class="formulaDsp">
\begin{equation}D\left(\vec{x},\vec{k},\omega\right)=\omega_{pe}+\frac{3}{2}\vec{k}\cdot\vec{k}v^{2}_{th}-\omega^{2}\equiv 0 \end{equation}
</p>
<p> It has no resonances. Waves cannot propagate below \(\omega_{pe}\) and \(v_{g}\) can never exceed \(v_{th}\). </p><div class="image">
<img src="bohm-gross.png" alt=""/>
</div>
<hr  />
 <h2><a class="anchor" id="dispersion_function_o_wave"></a>
Ordinary Wave</h2>
<p>This disperison function represents a wave with a \(\vec{E}_{1}||\vec{B}_{0}\). That means the electric field occilates parallel to the magnetic field. </p><p class="formulaDsp">
\begin{equation}D\left(\vec{x},\vec{k},\omega\right)=1-\frac{\omega^{2}_{pe}}{\omega^{2}}-\vec{n}_{\perp}\cdot\vec{n}_{\perp}\equiv 0 \end{equation}
</p>
<p> This wave is cut off below \(\omega_{pe}\). </p><div class="image">
<img src="O-Mode.png" alt=""/>
</div>
<hr  />
 <h2><a class="anchor" id="dispersion_function_x_wave"></a>
Extra Ordinary Wave</h2>
<p>This disperison function represents a wave with a \(\vec{E}_{1}\perp\vec{B}_{0}\). That means the electric field occilates perpendicular to the magnetic field. </p><p class="formulaDsp">
\begin{equation}D\left(\vec{x},\vec{k},\omega\right)=1-\frac{\omega_{pe}^2}{\omega^{2}}\frac{\omega^{2}-\omega_{pe}^2}{\omega^{2}-\omega_{h}^2}-\vec{n}_{\perp}\cdot\vec{n}_{\perp}\equiv 0 \end{equation}
</p>
<p> This mode has This wave has two branches. One branch is cannot not progagate below the \(\omega_{r}\) cutoff. The other branch cannot not progagate below the \(\omega_{l}\) cutoff. As the wave approches the upper hybrid fequency, wave propagation stops as the wave number approces \(\left|\vec{k}\right|\rightarrow\infty \). </p><div class="image">
<img src="X-Mode.png" alt=""/>
</div>
<hr  />
 <h2><a class="anchor" id="dispersion_function_cold_plasma"></a>
Cold Plasma</h2>
<p>This disperison function represents a wave in a cold plasma medium. </p><p class="formulaDsp">
\begin{equation}D\left(\vec{x},\vec{k},\omega\right)=det\left(\vec{\epsilon}+\vec{n}\vec{n}-\vec{n}\cdot\vec{n}\vec{I}\right)\equiv 0 \end{equation}
</p>
<p> The quantity \(\vec{\epsilon}\) is the diaelectric tensor. Using Onsager symmetries, this tensor is defined as </p><p class="formulaDsp">
\begin{equation}\vec{\epsilon}=\left(\begin{array}{ccc}\epsilon_{11}&amp;\epsilon_{12}&amp;0\\-\epsilon_{12}&amp;\epsilon_{11}&amp;0\\0&amp;0&amp;\epsilon_{33}\end{array}\right)\end{equation}
</p>
<p> where </p><p class="formulaDsp">
\begin{equation}\epsilon_{11}=1-\sum_{s}\frac{\frac{\omega^{2}_{p}}{\omega^{2}}}{1-\frac{\Omega^{2}_{c}}{\omega^{2}}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\epsilon_{12}=-i\sum_{s}\frac{\frac{\Omega_{c}}{\omega}\frac{\omega^{2}_{p}}{\omega^{2}}}{1-\frac{\Omega^{2}_{c}}{\omega^{2}}}\end{equation}
</p>
 <p class="formulaDsp">
\begin{equation}\epsilon_{33}=1-\sum_{s}\frac{\omega^{2}_{p}}{\omega^{2}}\end{equation}
</p>
<p> Note here we are including the plasma frequency for ions aswell. This dispersion function is effectively a super position of the O-Mode and X-Mode dispersion functions and as such has the same cutoffs and resonaces. </p><div class="image">
<img src="ColdPlasma.png" alt=""/>
</div>
<hr  />
 <h1><a class="anchor" id="dispersion_function_devel"></a>
Developing new dispersion functions</h1>
<p>This section is intended for code developers and outlines how to create new dispersion functions. New dispersion functions can be created from a subclass of <a class="el" href="classdispersion_1_1dispersion__function.html">dispersion::dispersion_function</a> or any other existing dispersion_function class and overloading class methods. For convinence the <a class="el" href="classdispersion_1_1physics.html">dispersion::physics</a> class contains several defined physical constants. </p><div class="fragment"><div class="line"><span class="keyword">template</span>&lt;jit::<span class="keywordtype">float</span>_scalar T, <span class="keywordtype">bool</span> SAFE_MATH=false&gt;</div>
<div class="line"><span class="keyword">class </span>new_dispersion final : <span class="keyword">public</span> dispersion_function&lt;T, SAFE_MATH&gt; {</div>
<div class="line">   ...</div>
<div class="line">};</div>
</div><!-- fragment --><p> When a new dispersion function is subclassed from <a class="el" href="classdispersion_1_1dispersion__function.html">dispersion::dispersion_function</a> an implimentation must be provided for the pure virtual method <a class="el" href="classdispersion_1_1dispersion__function.html#a30c60cf0ea23c4b7a89b4104a9991d3e">dispersion::dispersion_function::D</a>. </p><div class="fragment"><div class="line"><span class="keyword">template</span>&lt;jit::<span class="keywordtype">float</span>_scalar T, <span class="keywordtype">bool</span> SAFE_MATH=false&gt;</div>
<div class="line"><span class="keyword">class </span>new_dispersion final : <span class="keyword">public</span> dispersion_function&lt;T, SAFE_MATH&gt; {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">    <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> D(<a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> w,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> kx,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> ky,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> kz,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> x,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> y,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> z,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf&lt;T, SAFE_MATH&gt;</a> t,</div>
<div class="line">                                               <a class="code hl_typedef" href="namespaceequilibrium.html#a9f4ba1563110e2443131808c94663444">equilibrium::shared&lt;T, SAFE_MATH&gt;</a> &amp;eq) {</div>
<div class="line">       ...</div>
<div class="line">    }</div>
<div class="line">};</div>
<div class="ttc" id="anamespaceequilibrium_html_a9f4ba1563110e2443131808c94663444"><div class="ttname"><a href="namespaceequilibrium.html#a9f4ba1563110e2443131808c94663444">equilibrium::shared</a></div><div class="ttdeci">std::shared_ptr&lt; generic&lt; T, SAFE_MATH &gt; &gt; shared</div><div class="ttdoc">Convenience type alias for shared equilibria.</div><div class="ttdef"><b>Definition</b> equilibrium.hpp:472</div></div>
<div class="ttc" id="anamespacegraph_html_ac8853b055dcbbfd35dff9b4584d5ef36"><div class="ttname"><a href="namespacegraph.html#ac8853b055dcbbfd35dff9b4584d5ef36">graph::shared_leaf</a></div><div class="ttdeci">std::shared_ptr&lt; leaf_node&lt; T, SAFE_MATH &gt; &gt; shared_leaf</div><div class="ttdoc">Convenience type alias for shared leaf nodes.</div><div class="ttdef"><b>Definition</b> node.hpp:673</div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
