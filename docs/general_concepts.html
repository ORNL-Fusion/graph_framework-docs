<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.12.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Graph Framework: General Concepts</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">Graph Framework
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('general_concepts.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">General Concepts</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#general_concepts_introduction">Introduction</a>
  </li>
  <li class="level1">
    <a href="#general_concepts_definitions">Definitions</a>
  </li>
  <li class="level1">
    <a href="#general_concepts_graph">Graph</a>
  </li>
  <li class="level1">
    <a href="#general_concepts_diff">Auto Differentiation</a>
  </li>
  <li class="level1">
    <a href="#general_concepts_reduction">Reduction</a>
  </li>
  <li class="level1">
    <a href="#general_concepts_compile">Compile</a>
    <ul>
      <li class="level2">
        <a href="#general_concepts_compile_inputs">Inputs</a>
      </li>
      <li class="level2">
        <a href="#general_concepts_compile_outputs">Outputs</a>
      </li>
      <li class="level2">
        <a href="#general_concepts_compile_maps">Maps</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#general_concepts_workflow">Workflows</a>
  </li>
  <li class="level1">
    <a href="#general_concepts_safe_math">Safe Math</a>
  </li>
</ul>
</div>
<div class="textblock"><p>Overview of basic concepts of the graph_framework.</p>
<h1><a class="anchor" id="general_concepts_introduction"></a>
Introduction</h1>
<p>This page documents general concepts of the graph_framework.</p>
<h1><a class="anchor" id="general_concepts_definitions"></a>
Definitions</h1>
<a class="anchor" id="general_concepts_glossary"></a>
<table class="doxtable">
<caption>Glossary of terms</caption>
<tr>
<th>Concept </th><th>Definition </th></tr>
<tr>
<td><b>node</b> </td><td>A leaf or branch on the graph tree. </td></tr>
<tr>
<td><b>graph</b> </td><td>A data structure connecting nodes. </td></tr>
<tr>
<td><b>reduce</b> </td><td>A transformation of the graph to remove leaf_nodes. </td></tr>
<tr>
<td><b>auto differentiation</b></td><td>A transformation of the graph build derivatives. </td></tr>
<tr>
<td><b>compiler</b> </td><td>A tool for translating from one language to another. </td></tr>
<tr>
<td><b>JIT</b> </td><td>Just-in-time compile. </td></tr>
<tr>
<td><b>kernel</b> </td><td>A code function that runs on a batch of data. </td></tr>
<tr>
<td><b>pre_item</b> </td><td>A kernel to run before running the main kernels. </td></tr>
<tr>
<td><b>work_iten</b> </td><td>An instance of kernel. </td></tr>
<tr>
<td><b>converge_item</b> </td><td>A kernel that is run until a convergence test is met. </td></tr>
<tr>
<td><b>workflow</b> </td><td>A series of work items. </td></tr>
<tr>
<td><b>backend</b> </td><td>The device the kernel is run on. </td></tr>
<tr>
<td><b>recursion</b> </td><td>See definition of recursion. </td></tr>
<tr>
<td><b>safe math</b> </td><td>Run time checks to avoid off normal conditions. </td></tr>
<tr>
<td><b>API</b> </td><td>Application programming interface. </td></tr>
<tr>
<td><b>Host</b> </td><td>The place where kernels are launched from. </td></tr>
<tr>
<td><b>Device</b> </td><td>The side where kernels are run. </td></tr>
</table>
<hr  />
 <h1><a class="anchor" id="general_concepts_graph"></a>
Graph</h1>
<p>The graph_framework operates by building a tree structure of math operations. For an example of building expression structures see the <a class="el" href="tutorial.html#tutorial_expression">basic expressions tutorial</a>. In tree form it is easy to traverse nodes in the graph. Take the example of equation of a line. </p><p class="formulaDsp">
\begin{equation}y=mx + b\end{equation}
</p>
<p> This equation consists of five nodes. The ends of the tree are classified as either variables \(x\) or constants \(m,b\). These nodes are connected by nodes for multiply and addition operations. The output \(y\) represents the entire graph of operations. </p><div class="image">
<img src="line_graph.png" alt=""/>
<div class="caption">
The graph structure for y = mx + b.</div></div>
<p> Evaluation of graphs start from the top most node in this case the \(+\) operation. Evaluation of a node is not performed until all subnodes are evaluated starting with the left operand. Evaluation starts by recursively evaluating the left operands until the last node is reached \(m\). </p><div class="image">
<img src="line_graph_eval1.png" alt=""/>
</div>
<p> Once \(m\) the result is returned to the \(+\) then the right operand is evaluated. </p><div class="image">
<img src="line_graph_eval2.png" alt=""/>
</div>
<p> Evaluation is repeated until every node in the graph is evaluated. </p><div class="image">
<img src="line_graph_eval_final.png" alt=""/>
</div>
<hr  />
 <h1><a class="anchor" id="general_concepts_diff"></a>
Auto Differentiation</h1>
<p>From the previous <a class="el" href="#general_concepts_graph">section</a>, it was shown how graphs can be evaluated. This same evaluation can be applied to build graphs of a function derivative. For an example of taking derivatives see the <a class="el" href="tutorial.html#tutorial_derivatives">auto differentiation tutorial</a>. Lets say that we want to take the derivative of \(\frac{\partial y}{\partial x}\). This is achieved by evaluating the until bottom left most node is reached. Then a new graph is build starting with \(\frac{\partial m}{\partial x}=0\). Applying the first half of the chain rule we build a new graph for \(0x\) </p><div class="image">
<img src="line_graph_dydf1.png" alt=""/>
</div>
<p> Then we take the derivative of the right operand and apply the second half of the chain rule to build a new graph for \(0x=0\). </p><div class="image">
<img src="line_graph_dydf2.png" alt=""/>
</div>
<p> Evaluation is repeated recursively until the full graph has been evaluated. </p><div class="image">
<img src="line_graph_dydf_final.png" alt=""/>
</div>
<hr  />
 <h1><a class="anchor" id="general_concepts_reduction"></a>
Reduction</h1>
<p>The final expression for \(\frac{\partial y}{\partial x}\) contains many unnecessary nodes in the graph. Instead of building full graphs, we can simplify and eliminate nodes as we build them. For instance, when the expression \(0x\) this created can be immediately reduce it to a single node. </p><div class="image">
<img src="line_graph_reduce1.png" alt=""/>
</div>
<p> Applying all possible reductions reduces the final expression to \(\frac{\partial y}{\partial x}=m\). </p><div class="image">
<img src="line_graph_reduce_final.png" alt=""/>
</div>
<p> By reducing graphs as they are build, we can eliminate nodes one by one.</p>
<hr  />
 <h1><a class="anchor" id="general_concepts_compile"></a>
Compile</h1>
<p>Once graph expressions are built, they can be compiled to a compute kernel. For an example of compiling expression trees into kernels see the <a class="el" href="tutorial.html#tutorial_workflow">workflow tutorial</a>. Using the same recursive evaluation, we can visit each node of a graph and and create a line of kernel source code. There are three important parts for creating kernels, inputs, outputs, and maps. These three concepts define buffers on the compute device and how they are changed. Compute kernels can be generated from multiple outputs and maps.</p>
<h2><a class="anchor" id="general_concepts_compile_inputs"></a>
Inputs</h2>
<p>Inputs are the variable nodes that define the graph inputs. In the line example \(\frac{\partial y}{\partial x}\), the input variable would be the node for \(x\). Some graphs have no inputs. The graph for \(\frac{\partial y}{\partial x}=m\) has eliminated all the variable nodes in the graph.</p>
<h2><a class="anchor" id="general_concepts_compile_outputs"></a>
Outputs</h2>
<p>Outputs are the ends of the nodes. These are the values we want to compute. Any node of a graph can be a potential output. For each output a device buffer is generated to store the results of the evaluation. For nodes that are not used as outputs, no buffers need to be created since those results are never stored.</p>
<h2><a class="anchor" id="general_concepts_compile_maps"></a>
Maps</h2>
<p>Maps enable the results of an output node to be stored in an input node. This is use for a wide variety of steps. For instance take a gradient decent step. </p><p class="formulaDsp">
\begin{equation}y = y + \frac{\partial f}{\partial x}\end{equation}
</p>
<p> In this case the output of the expression \(y + \frac{\partial f}{\partial x}\) can be mapped to update \(y\).</p>
<hr  />
 <h1><a class="anchor" id="general_concepts_workflow"></a>
Workflows</h1>
<p>Sequences of kernels are evaluated in workflow. A workflow is defined from workitems which wrap a kernel call.</p>
<hr  />
 <h1><a class="anchor" id="general_concepts_safe_math"></a>
Safe Math</h1>
<p>There are some conditions where mathematically, a graph should evaluate to a normal number. However, when evaluated using floating point precision, can lead to <code>Inf</code> or <code>NaN</code>. An example of this the \(\exp\left(x\right)\) function. For large argument values, \(\exp\left(x\right)\) overflows the maximum floating point precision and returns <code>Inf</code>. \(\frac{1}{\exp\left(x\right)}\) should evaluate zero however, in floating point this becomes a <code>NaN</code>. Safe math avoids problems like this by checking for large argument values. But since these run time checks slow down kernel evaluation, most of the time safe math should be avoided. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.12.0 </li>
  </ul>
</div>
</body>
</html>
